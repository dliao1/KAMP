<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>KAMP univariate expectation — kamp_expectation • kperm</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="KAMP univariate expectation — kamp_expectation"><meta name="description" content="Computes the KAMP (K-function Adjusted for Marked Permutations) expectation
for a given spatial point pattern. This function calculates Ripley's K
using both the traditional Ripley's K method (based on Kcross)
and the KAMP-adjusted CSR baseline (based on Kest).
The KAMP-adjusted CSR represents a more robust baseline for K (compared
to traditional CSR) that accounts for spatial clustering or inhomogeneity
in a point pattern compared to the traditional CSR assumption, while
avoiding the computational burden of permuting the point pattern.
Notes:
This function uses the spatstat package under the hood, which
automatically uses border correction when the number of
points in the point pattern is more than 3000.
See ?Kcross and ?Kest for more details on the K calculation methods.
See kamp_expectation_mat for the matrix-based implementation."><meta property="og:description" content="Computes the KAMP (K-function Adjusted for Marked Permutations) expectation
for a given spatial point pattern. This function calculates Ripley's K
using both the traditional Ripley's K method (based on Kcross)
and the KAMP-adjusted CSR baseline (based on Kest).
The KAMP-adjusted CSR represents a more robust baseline for K (compared
to traditional CSR) that accounts for spatial clustering or inhomogeneity
in a point pattern compared to the traditional CSR assumption, while
avoiding the computational burden of permuting the point pattern.
Notes:
This function uses the spatstat package under the hood, which
automatically uses border correction when the number of
points in the point pattern is more than 3000.
See ?Kcross and ?Kest for more details on the K calculation methods.
See kamp_expectation_mat for the matrix-based implementation."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">kperm</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/my-vignette.html">Introduction to kperm</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>KAMP univariate expectation</h1>

      <div class="d-none name"><code>kamp_expectation.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Computes the KAMP (K-function Adjusted for Marked Permutations) expectation
for a given spatial point pattern. This function calculates Ripley's K
using both the traditional Ripley's K method (based on <code>Kcross</code>)
and the KAMP-adjusted CSR baseline (based on <code>Kest</code>).</p>
<p>The KAMP-adjusted CSR represents a more robust baseline for K (compared
to traditional CSR) that accounts for spatial clustering or inhomogeneity
in a point pattern compared to the traditional CSR assumption, while
avoiding the computational burden of permuting the point pattern.</p>
<p>Notes:</p>
<p>This function uses the <code>spatstat</code> package under the hood, which
automatically uses border correction when the number of
points in the point pattern is more than 3000.</p>
<p>See <code>?Kcross</code> and <code>?Kest</code> for more details on the K calculation methods.</p>
<p>See <code>kamp_expectation_mat</code> for the matrix-based implementation.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">kamp_expectation</span><span class="op">(</span></span>
<span>  <span class="va">ppp_obj</span>,</span>
<span>  rvec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.05</span>, <span class="fl">0.075</span>, <span class="fl">0.1</span>, <span class="fl">0.15</span>, <span class="fl">0.2</span><span class="op">)</span>,</span>
<span>  correction <span class="op">=</span> <span class="st">"trans"</span>,</span>
<span>  markvar <span class="op">=</span> <span class="st">"immune"</span>,</span>
<span>  thin_pct <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-ppp-obj">ppp_obj<a class="anchor" aria-label="anchor" href="#arg-ppp-obj"></a></dt>
<dd><p>A point pattern object from the <code>spatstat.geom</code> package.</p></dd>


<dt id="arg-rvec">rvec<a class="anchor" aria-label="anchor" href="#arg-rvec"></a></dt>
<dd><p>Vector of radii at which to calculate the KAMP expectation. Defaults to c(0, 0.05, 0.075, 0.1, 0.15, 0.2).</p></dd>


<dt id="arg-correction">correction<a class="anchor" aria-label="anchor" href="#arg-correction"></a></dt>
<dd><p>Type of edge correction method to be used and passed to <code>Kcross</code> and <code>Kest</code>. Defaults to translational edge correction.</p></dd>


<dt id="arg-markvar">markvar<a class="anchor" aria-label="anchor" href="#arg-markvar"></a></dt>
<dd><p>Identifies subset of marked points. Defaults to immune.</p></dd>


<dt id="arg-thin-pct">thin_pct<a class="anchor" aria-label="anchor" href="#arg-thin-pct"></a></dt>
<dd><p>Percentage that determines how much to thin the amount of points in the point pattern object. Defaults to 0.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A dataframe with the following columns:</p><dl><dt>r</dt>
<dd><p>The radius at which K was calculated.</p></dd>

<dt>k</dt>
<dd><p>The observed K value from <code>Kcross</code></p></dd>

<dt>theo_csr</dt>
<dd><p>The theoretical K under CSR from <code>Kcross</code></p></dd>

<dt>kamp_csr</dt>
<dd><p>The adjusted CSR representing the permuted expectation.</p></dd>

<dt>kamp_fundiff</dt>
<dd><p>The difference between observed K and KAMP CSR</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Compute KAMP Expectation</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"spatstat.geom"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="co"># simulates a simple spatial point pattern with two types</span></span></span>
<span class="r-in"><span>  <span class="va">win</span> <span class="op">&lt;-</span> <span class="fu">spatstat.geom</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/spatstat.geom/man/owin.html" class="external-link">owin</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">pp</span> <span class="op">&lt;-</span> <span class="fu">spatstat.random</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/spatstat.random/man/rpoispp.html" class="external-link">rpoispp</a></span><span class="op">(</span>lambda <span class="op">=</span> <span class="fl">100</span>, win <span class="op">=</span> <span class="va">win</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">marks</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"immune"</span>, <span class="st">"background"</span><span class="op">)</span>, <span class="va">pp</span><span class="op">$</span><span class="va">n</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">marked_pp</span> <span class="op">&lt;-</span> <span class="fu">spatstat.geom</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/spatstat.geom/man/ppp.html" class="external-link">ppp</a></span><span class="op">(</span><span class="va">pp</span><span class="op">$</span><span class="va">x</span>, <span class="va">pp</span><span class="op">$</span><span class="va">y</span>, window <span class="op">=</span> <span class="va">win</span>, marks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">marks</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># computes KAMP expectation</span></span></span>
<span class="r-in"><span>  <span class="va">kamp_result</span> <span class="op">&lt;-</span> <span class="fu">kamp_expectation</span><span class="op">(</span><span class="va">marked_pp</span>, markvar <span class="op">=</span> <span class="st">"immune"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">kamp_result</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 6 × 5</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       r       k theo_csr kamp_csr kamp_fundiff</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> 0     0        0        0            0      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> 0.05  0.009<span style="text-decoration: underline;">70</span>  0.007<span style="text-decoration: underline;">85</span>  0.005<span style="text-decoration: underline;">86</span>      0.003<span style="text-decoration: underline;">84</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> 0.075 0.021<span style="text-decoration: underline;">1</span>   0.017<span style="text-decoration: underline;">7</span>   0.014<span style="text-decoration: underline;">4</span>       0.006<span style="text-decoration: underline;">69</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span> 0.1   0.032<span style="text-decoration: underline;">8</span>   0.031<span style="text-decoration: underline;">4</span>   0.026<span style="text-decoration: underline;">7</span>       0.006<span style="text-decoration: underline;">14</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span> 0.15  0.080<span style="text-decoration: underline;">9</span>   0.070<span style="text-decoration: underline;">7</span>   0.070<span style="text-decoration: underline;">5</span>       0.010<span style="text-decoration: underline;">3</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">6</span> 0.2   0.137    0.126    0.128        0.009<span style="text-decoration: underline;">06</span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Daisy Liao.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer></div>





  </body></html>

